import {Component, OnInit} from '@angular/core';
import {CommonModule} from '@angular/common';
import {BookRequest} from '../../../../services/models/book-request';
import {FormsModule} from '@angular/forms';
import {ActivatedRoute, Router, RouterLink} from '@angular/router';
import {BookService} from '../../../../services/services/book.service';

@Component({
  selector: 'app-manage-book',
  standalone: true,
  imports: [CommonModule, FormsModule, RouterLink],
  templateUrl: './manage-book.component.html',
  styleUrl: './manage-book.component.scss'
})
export class ManageBookComponent implements OnInit {
  img= 'data:image/jpeg;base64,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';


  errorMsg: Array<string> = [];
  selectedBookCover: any;
  selectedPicture: string | undefined;
  bookRequest: BookRequest = {authorName: "", isbn: "", synopsis: "", title: ""};

  constructor(private bookService: BookService, private router: Router, private activatedRoute: ActivatedRoute) {
  }

  ngOnInit(): void {
    const bookId = this.activatedRoute.snapshot.params['bookId'];
    if(bookId){
      this.bookService.findBookById({
        'book-id': bookId
      }).subscribe({
        next: (book) => {
          this.bookRequest = {
            id: book.id,
            title: book.title as string,
            authorName: book.authorName as string,
            isbn: book.isbn as string,
            synopsis: book.synopsis as string,
            shareable: book.shareable
          }
          if (book.cover) {
            this.selectedPicture = 'data:image/jpeg;base64,' + book.cover;
          }
        }
      })
    }
  }

  onFileSelected(event: any) {
    this.selectedBookCover = event.target.files[0];
    console.log(this.selectedBookCover);
    if (this.selectedBookCover) {
      const reader = new FileReader();
      reader.onload = () => {
        this.selectedPicture = reader.result as string;
      }
      reader.readAsDataURL(this.selectedBookCover);
    }
  }

  saveBook() {
    console.log(this.bookRequest);
    this.bookService.saveBook({
      body: this.bookRequest
    }).subscribe({
      next: (bookId) => {
        this.bookService.uploadBookCoverPicture({
          'book-id': bookId,
          body: {
            file: this.selectedBookCover
          }
        }).subscribe({
          next: () => {
            this.router.navigate(['/books/my-books']);
          }
        })
      },
      error: (err) => {
        this.errorMsg = err.error.validationErrors;
      }
    });
  }
}
